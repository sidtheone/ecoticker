# Epic 7 Retrospective: UX Foundations

**Date:** 2026-02-22
**Facilitator:** Bob (Scrum Master)
**Participants:** Alice (PO), Bob (SM), Charlie (Senior Dev), Dana (QA), Elena (Junior Dev), Sidhartharora (Project Lead)

## Epic Summary

- **Epic:** 7 ‚Äî UX Foundations (Visual Severity Layer)
- **Goal:** Implement the visual severity communication layer from the UX design spec: severity gauge, unified color utility, hero section, product descriptor, stale data warning, topic card enhancements, editorial detail page layout. Close the "cold-landing legibility gap" ‚Äî the spec's #1 retention risk.
- **Stories Completed:** 5/5 (100%)
- **All stories Size S**
- **Tests:** 325 ‚Üí 447 (+122 new tests)
- **Blockers:** 0
- **Production Incidents:** 0
- **Code Reviews:** 5/5 stories reviewed
- **Technical Debt Items:** 1 minor (SeverityGauge compact mode ignores height prop)

## Successes

- **Critical path executed cleanly:** `severityColor()` ‚Üí `SeverityGauge` ‚Üí Hero ‚Üí Cards ‚Üí Detail page. Each story built on the previous one with zero dependency surprises.
- **Unified color utility (Story 7-1)** replaced 3 separate functions (`scoreToHex`, `urgencyColor`, `changeColor`) with one coherent `severityColor(score)` API. Every subsequent story consumed it ‚Äî compound DRY payoff.
- **122 new tests** across the epic. Test coverage maintained despite major component restructuring.
- **Story 7-3's pragmatic engineering:** Used `scoreHistory.recordedAt` as a proxy for batch freshness since `batch_runs` table doesn't exist yet. One `<p>` tag for the product descriptor. Simple solutions that work.
- **Story 7-5 (editorial layout)** restructured the entire topic detail page ‚Äî the social share arrival landing page ‚Äî with 14 edge cases pre-documented in Dev Notes.
- **Architecture audit alignment improved:** from 67% to ~90% after Epic 7. The visual severity communication layer is complete.
- **Cold-landing legibility gap closed:** First-time visitors now get the severity glance (badge ‚Üí gauge ‚Üí number) within 0‚Äì3 seconds.

## Challenges

- **Story 7-4 TDD bug:** jsdom normalizes inline style hex colors (`#dc2626`) to `rgb()` format (`rgb(220, 38, 38)`). 7 border color test assertions had to be rewritten. This is a testing environment gotcha, not a code bug.
- **SeverityGauge compact mode ignores `height` prop:** Hardcodes 8px. Card gauge and hero gauge render at the same thickness despite the UX spec wanting different sizes (6px vs 10px). Cosmetic ‚Äî not blocking launch.
- **Story file status drift:** Story files show "ready-for-dev" status while sprint-status shows "done". Only Story 7-4 has a filled Dev Agent Record section. Story file lifecycle tracking is inconsistent.

## Key Insights

1. **A unified design token utility pays compound interest across an epic.** `severityColor()` was consumed by every subsequent story (hero, cards, detail page, dimensions). Investing in the foundation (Story 7-1) made 7-2 through 7-5 faster.
2. **Editorial layout restructures are high-risk, high-reward.** Story 7-5 had the most edge cases (14) and the highest stakes (social share landing page). Thorough Dev Notes prevented surprises.
3. **jsdom normalizes CSS values differently than real browsers.** Hex ‚Üí rgb() in inline styles. Test assertions must account for this. Document as a project-wide testing convention.
4. **Pragmatic proxies beat perfect solutions.** Story 7-3 used `scoreHistory.recordedAt` instead of waiting for a `batch_runs` table. Shipped the feature, deferred the ideal implementation.

## Previous Retrospective Follow-Through (Epic 4)

Epic 4 retro action items were primarily executed in Epic 8 (tech debt cleanup). Epic 7 carried forward all team agreements:

- Code review mandatory ‚úÖ
- Small stories preferred ‚úÖ (all 5 are Size S)
- Dev Notes drive implementation ‚úÖ
- LLM boundary validation in Dev Notes ‚úÖ (N/A for most UX stories ‚Äî correctly omitted)
- No deferred cleanup ‚úÖ (SeverityGauge height prop noted, not deferred ‚Äî documented here)

The OG branded image (carried from Epic 3 retro) remains ‚è≥ In Progress.

## Action Items

### Process Improvements

1. **Add jsdom CSS normalization to project testing conventions**
   - Owner: Dana (QA)
   - Detail: Document that jsdom normalizes inline style hex values to `rgb()`. Update CLAUDE.md or testing docs.
   - Success criteria: No future tests use raw hex assertions for inline styles

2. **Fill Dev Agent Record for all completed stories**
   - Owner: Bob (SM)
   - Detail: Story files should be updated to "done" status with completion notes when stories are marked done in sprint-status
   - Success criteria: Story file status matches sprint-status for all future stories

### Technical Debt

1. **SeverityGauge compact mode should respect `height` prop** ‚Äî Priority: LOW. Cosmetic only. Not blocking launch.

### Team Agreements (carried forward)

- Code review is mandatory
- Small stories preferred ‚Äî break M+ into Smalls
- Dev Notes drive implementation
- LLM boundary validation section in Dev Notes for all LLM stories
- No deferred cleanup ‚Äî create story immediately
- Front-load risk discovery into story creation phase
- **NEW: Inline style color assertions in tests must use `rgb()` format, not hex**

## Deployment

**Epics 4 + 7 + 8 deploy together.** This is the launch release:
- Resilient pipeline (Epic 4: RSS + GNews dual-source, feed health, aligned scoring)
- Visual severity layer (Epic 7: gauge, hero, cards, detail page, stale warning)
- Clean codebase (Epic 8: shared pipeline module, fixed defaults, renamed tests)
- 447 tests passing, TypeScript clean, build green

## Next Epic

**Epic 5: Admin & Measurement** (backlog)
- 6 stories: keyword management (5.1‚Äì5.3), analytics (5.4‚Äì5.5), batch health dashboard (5.6)
- 3 Size M stories should be evaluated for splitting
- Story 5.6 directly benefits from Epic 8's shared `batch-pipeline.ts` module

## Significant Discoveries

No significant discoveries that change Epic 5's plan. Epic 7 delivered the complete visual severity layer as designed. The only minor gap is the SeverityGauge height prop (cosmetic).

## Team Performance

Epic 7 delivered 5 stories with 122 new tests, closing the #1 retention risk (cold-landing legibility gap). The unified `severityColor()` utility paid compound dividends across every story. The team's critical path discipline ‚Äî building each story on the foundation of the previous ‚Äî was exemplary. Ready to launch.

**Project Lead sentiment:** "Fresh UX, good vibes. Let's launch soon." üöÄ
